# Установка и настройка скрипта
Для работы "rss2post" подойдет любой хостинг с поддержкой php или локально запущенный сервер (denwer, wamp и другие). 

Например, скрипт скопирован на сервер в папку rss2post, <b>рабочий адрес</b> будет такой: 
<blockquote>yoursite.com/rss2post/cron.php
</blockquote>
После настройки, для автоматического запуска через каждые 5 минут, рекомендуется добавить задачу в cron:
<blockquote>curl -s '<b>рабочий адрес</b>' > /dev/null<br>
<nowiki>*/5 * * * *</nowiki>
</blockquote>
## Настройки RSS.
Параметр '<b>rssFeedUrl</b>' — адрес rss-ленты.<br>
Пример: http://habrahabr.ru/rss/best/

Параметр '<b>extractImages</b>' — извлекать ли картинки из новости?<br>
Берется первая картинка из текста новости, если она там есть.<br>
true: извлекать.<br>
false: не извлекать.

Параметр '<b>actualDate</b>' —  RSS-новости опубликованные раньше этой даты игнорируются.<br>
Пригодится, если нужно начать постить новости, начиная с конкретной даты. Или false, если не надо.<br>
Пример: '01/23/2014'.

## Настройки VK
Параметр '<b>vkAccessToken</b>' — токен для доступа к VK.<br>
<blockquote>
<b>Получение токена:</b><br><br>

1) Создать в VK standalone-приложение.<br>
https://vk.com/editapp?act=create<br><br>

2) Вставить <b>id</b> созданного приложения в ссылку вместо <b>12345678</b>:<br>
<nowiki>
https://oauth.vk.com/authorize?client_id=12345678&scope=wall,photos,offline&redirect_uri=https://oauth.vk.com/blank.html&display=page&v=5.28&response_type=token
</nowiki><br><br>

3) После перехода по ссылке и подтверждения доступа в адресной строке появится токен в параметре "<b>access_token</b>": <br>
<nowiki>
https://oauth.vk.com/blank.html#access_token=TOKENb&expires_in=0&user_id=123456789
</nowiki><br><br>

4) Т.к. мы используем приложение для себя и сами себя взламывать через него скорее всего не будем, то игнорируем прежупреждение "Пожалуйста, не копируйте данные из адресной строки для сторонних сайтов. Таким образом Вы можете потерять доступ к Вашему аккаунту."<br>
Копирум подстроку "<b>TOKEN</b>" и вставляем в конфиг. 
</blockquote>

Параметр <b>vkPublicID</b> — ID группы или пользователя, где небходимо опубликовать пост.<br>
ID группы указывается со знаком минус вначале, ID пользователя без.<br>
Например, для группы rss2post: -88230482<br>

Параметр <b>fromGroup</b> — Пост от имени группы (1) или от имени пользователя (0).<br>

Параметр <b>postTemplate</b> — Полностью настраиваемый шаблон поста.<br>
В переменную $rssItem передаются все поля из RSS-узла <item><br>
Можно использовать функцию Rss2Post::decodeHtmlEnt для декодирования сущностей навроде &amp; => &
<br>
# Логика работы скрипта
1) Получает список rss-новостей и определяет их актуальность (по записи в логе, в который пишется дата последней добавленной новости). <br>

2) Если есть актуальные, еще не опубликованные новости, то скачивается картинка из новости, заливается в VK, формируется пост по заданному шаблону и к нему прикрепляется картинка.<br>
Если скачать картинку не удалось (например, защита от хотлинка), то публикуется пост без картинки.<br>

3) Если пост был успешно добавлен, то в лог записывается дата последней добавленной новости.
Если что-то пошло не так, то появляется файл с логом ошибок.<br>

<blockquote>Код писался для себя, далеко не идеален, но сбоев замечено не было и со своей задачей справляется уже продолжительное время.
Пример работы: https://vk.com/webdevrss
</blockquote>

Успехов!